{"metadata":{"usedHelpers":["typeof","interopRequireDefault"],"marked":[],"modules":{"imports":[],"exports":{"exported":["name"],"specifiers":[{"kind":"local","local":"name","exported":"name"}]}}},"options":{"filename":"/packages/muqube:autoform-selectable/autoform-selectable.js","filenameRelative":"/packages/muqube:autoform-selectable/autoform-selectable.js","env":{},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/packages/muqube:autoform-selectable/autoform-selectable.js.map","sourceFileName":"/packages/muqube:autoform-selectable/autoform-selectable.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"basename":"autoform-selectable"},"ignored":false,"code":"exports.__esModule = true;\nexports.name = undefined;\n\nvar _typeof2 = require(\"babel-runtime/helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar name = exports.name = 'muqube:autoform-selectable';\n\nAutoForm.addInputType(\"selectable\", {\n    template: \"afSelectable\",\n    valueOut: function valueOut() {\n        var data = this.data();\n        var selection = this.find('.selected.selectable-option');\n\n        if (data.multiple) {\n            var _ret = function () {\n                var values = [];\n                selection.each(function (index, elem) {\n                    values.push($(elem).data('value'));\n                });\n                return {\n                    v: values\n                };\n            }();\n\n            if ((typeof _ret === \"undefined\" ? \"undefined\" : (0, _typeof3[\"default\"])(_ret)) === \"object\") return _ret.v;\n        } else {\n            return selection.data('value');\n        }\n    }\n});\n\nTemplate.afSelectable.helpers({\n    atts: function atts() {\n        var data = Template.currentData();\n        var atts = data.atts;\n        atts[\"data-multiple\"] = data.atts[\"multiple\"];\n        atts[\"data-schema-key\"] = data.atts[\"data-schema-key\"];\n\n        return atts;\n    },\n    isOptionSelected: function isOptionSelected(option) {\n        var value = Template.currentData().value;\n        var isSelected = false;\n\n        if (Array.isArray(value)) {\n            isSelected = value.indexOf(option) != -1;\n        } else {\n            isSelected = option === value;\n        }\n\n        return isSelected ? \"selected\" : \"\";\n    },\n    options: function options() {\n        var data = Template.currentData();\n        return data.selectOptions;\n    }\n});\n\nTemplate.afSelectable.events({\n    'click .selectable-option': function clickSelectableOption(e, t) {\n        var target = $(e.target),\n            isMultiple = t && t.data && t.data.atts && t.data.atts.multiple,\n            isSelected = target.hasClass('selected'),\n            numSelected = t.findAll('.selected.selectable-option').length,\n            min = t.data.atts.min || Number.MIN_SAFE_INTEGER,\n            max = t.data.atts.max || Number.MAX_SAFE_INTEGER;\n\n        if (isMultiple) {\n            if (min < numSelected && isSelected || numSelected < max && !isSelected) {\n                target.toggleClass('selected');\n            }\n        } else {\n            target.toggleClass('selected');\n            target.siblings().removeClass('selected');\n        }\n    }\n});","ast":null,"map":{"version":3,"sources":["/packages/muqube:autoform-selectable/autoform-selectable.js"],"names":[],"mappings":";;;;;;;;;AAAO,IAAM,sBAAO,4BAAb;;AAEP,SAAS,YAAT,CAAsB,YAAtB,EAAoC;AAChC,cAAU,cADsB;AAEhC,cAAU,oBAAW;AACjB,YAAM,OAAO,KAAK,IAAL,EAAb;AACA,YAAI,YAAY,KAAK,IAAL,CAAU,6BAAV,CAAhB;;AAEA,YAAI,KAAK,QAAT,EAAmB;AAAA;AACf,oBAAI,SAAS,EAAb;AACA,0BAAU,IAAV,CAAe,UAAC,KAAD,EAAQ,IAAR,EAAiB;AAC5B,2BAAO,IAAP,CAAY,EAAE,IAAF,EAAQ,IAAR,CAAa,OAAb,CAAZ;AACH,iBAFD;AAGA;AAAA,uBAAO;AAAP;AALe;;AAAA;AAMlB,SAND,MAMO;AACH,mBAAO,UAAU,IAAV,CAAe,OAAf,CAAP;AACH;AACJ;AAf+B,CAApC;;AAkBA,SAAS,YAAT,CAAsB,OAAtB,CAA8B;AAC1B,UAAM,gBAAY;AACd,YAAI,OAAO,SAAS,WAAT,EAAX;AACA,YAAI,OAAO,KAAK,IAAhB;AACA,aAAK,eAAL,IAAwB,KAAK,IAAL,CAAU,UAAV,CAAxB;AACA,aAAK,iBAAL,IAA0B,KAAK,IAAL,CAAU,iBAAV,CAA1B;;AAEA,eAAO,IAAP;AACH,KARyB;AAS1B,oBAT0B,4BASR,MATQ,EASA;AACtB,YAAM,QAAQ,SAAS,WAAT,GAAuB,KAArC;AACA,YAAI,aAAa,KAAjB;;AAEA,YAAI,MAAM,OAAN,CAAc,KAAd,CAAJ,EAA0B;AACtB,yBAAa,MAAM,OAAN,CAAc,MAAd,KAAyB,CAAC,CAAvC;AACH,SAFD,MAEO;AACH,yBAAa,WAAW,KAAxB;AACH;;AAED,eAAQ,UAAD,GAAc,UAAd,GAA2B,EAAlC;AACH,KApByB;AAqB1B,WArB0B,qBAqBhB;AACN,YAAI,OAAO,SAAS,WAAT,EAAX;AACA,eAAO,KAAK,aAAZ;AACH;AAxByB,CAA9B;;AA2BA,SAAS,YAAT,CAAsB,MAAtB,CAA6B;AACzB,8BADyB,iCACE,CADF,EACK,CADL,EACQ;AAC7B,YAAM,SAAS,EAAE,EAAE,MAAJ,CAAf;AAAA,YACI,aAAa,KAAK,EAAE,IAAP,IAAe,EAAE,IAAF,CAAO,IAAtB,IAA8B,EAAE,IAAF,CAAO,IAAP,CAAY,QAD3D;AAAA,YAEI,aAAa,OAAO,QAAP,CAAgB,UAAhB,CAFjB;AAAA,YAGI,cAAc,EAAE,OAAF,CAAU,6BAAV,EAAyC,MAH3D;AAAA,YAII,MAAM,EAAE,IAAF,CAAO,IAAP,CAAY,GAAZ,IAAmB,OAAO,gBAJpC;AAAA,YAKI,MAAM,EAAE,IAAF,CAAO,IAAP,CAAY,GAAZ,IAAmB,OAAO,gBALpC;;AAOA,YAAI,UAAJ,EAAe;AACX,gBAAO,MAAM,WAAP,IAAuB,UAAxB,IAAyC,cAAc,GAAf,IAAuB,CAAC,UAArE,EAAmF;AAC/E,uBAAO,WAAP,CAAmB,UAAnB;AACH;AACJ,SAJD,MAIO;AACH,mBAAO,WAAP,CAAmB,UAAnB;AACA,mBAAO,QAAP,GAAkB,WAAlB,CAA8B,UAA9B;AACH;AACJ;AAjBwB,CAA7B","file":"/packages/muqube:autoform-selectable/autoform-selectable.js.map","sourcesContent":["export const name = 'muqube:autoform-selectable';\n\nAutoForm.addInputType(\"selectable\", {\n    template: \"afSelectable\",\n    valueOut: function() {\n        const data = this.data();\n        let selection = this.find('.selected.selectable-option');\n\n        if (data.multiple) {\n            let values = [];\n            selection.each((index, elem) => {\n                values.push($(elem).data('value'));\n            });\n            return values;\n        } else {\n            return selection.data('value');\n        }\n    }\n});\n\nTemplate.afSelectable.helpers({\n    atts: function () {\n        var data = Template.currentData();\n        var atts = data.atts;\n        atts[\"data-multiple\"] = data.atts[\"multiple\"];\n        atts[\"data-schema-key\"] = data.atts[\"data-schema-key\"];\n\n        return atts;\n    },\n    isOptionSelected (option) {\n        const value = Template.currentData().value;\n        let isSelected = false;\n\n        if (Array.isArray(value)) {\n            isSelected = value.indexOf(option) != -1;\n        } else {\n            isSelected = option === value;\n        }\n\n        return (isSelected)? \"selected\" : \"\" ;\n    },\n    options() {\n        var data = Template.currentData();\n        return data.selectOptions;\n    }\n});\n\nTemplate.afSelectable.events({\n    'click .selectable-option'(e, t) {\n        const target = $(e.target),\n            isMultiple = t && t.data && t.data.atts && t.data.atts.multiple,\n            isSelected = target.hasClass('selected'),\n            numSelected = t.findAll('.selected.selectable-option').length,\n            min = t.data.atts.min || Number.MIN_SAFE_INTEGER,\n            max = t.data.atts.max || Number.MAX_SAFE_INTEGER;\n        \n        if (isMultiple){ \n            if ( ((min < numSelected) && isSelected) || ((numSelected < max) && !isSelected) ) {\n                target.toggleClass('selected');\n            }\n        } else {\n            target.toggleClass('selected');\n            target.siblings().removeClass('selected');\n        }\n    }\n});"]},"hash":"38b9249b3c010b5a4381069dc5a20340b35eb8cf"}
